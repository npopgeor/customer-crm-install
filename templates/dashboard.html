{% extends 'layout.html' %}
{% block content %}
<div class="row g-4">

  
  {% for customer in customer_cards %}
  <div class="col-md-6 col-xl-4">
    <div class="card shadow-lg border-0 rounded-4 position-relative p-3 hover-shadow" style="min-height: 260px; cursor: pointer;"
         onclick="window.location='{{ url_for('customer_detail', id=customer.id) }}'">
      
      <!-- Logo in top-left corner -->
      <img src="/static/logos/{{ customer.name | replace(' ', '_') | lower }}.png"
           alt="{{ customer.name }} logo"
           class="position-absolute"
           style="top: 16px; left: 40px; width: 100px; opacity: 1; z-index: 1;">

      <!-- View Details button in top-right -->
      <div class="position-absolute top-0 end-0 mt-3 me-3">
        <a href="{{ url_for('customer_detail', id=customer.id) }}" class="btn btn-sm btn-outline-dark">View Details</a>
        <a href="{{ url_for('edit_customer', id=customer.id) }}" class="btn btn-sm btn-outline-warning ms-2">âœï¸ Edit</a>

      </div>

      <!-- Main Content -->
      <div class="card-body pt-5 mt-3">
        <div class="list-group mb-2">
          <a href="{{ url_for('action_item_list') }}?customer_id={{ customer.id }}"
            class="list-group-item list-group-item-action d-flex justify-content-between align-items-center rounded"
            onclick="event.stopPropagation();">
            
            <div class="d-flex align-items-center">
              âœ… Open AIs
              {% if customer.open_ais >= 5 %}
                <span class="badge bg-danger ms-2">High!</span>  <!-- ğŸ”´ small badge, next to label -->
              {% endif %}
            </div>
        
            <span class="badge bg-warning rounded-pill">{{ customer.open_ais }}</span>  <!-- number stays right -->
          </a>
       
          <a href="{{ url_for('meeting_list') }}?customer_id={{ customer.id }}"
             class="list-group-item list-group-item-action d-flex justify-content-between align-items-center rounded"
             onclick="event.stopPropagation();">
            ğŸ—“ Past Meetings
            <span class="badge bg-info rounded-pill">{{ customer.past_meetings }}</span>
          </a>
          
          <a href="{{ url_for('recurring_meeting_list') }}?customer_id={{ customer.id }}"
            class="list-group-item list-group-item-action d-flex justify-content-between align-items-center rounded"
            onclick="event.stopPropagation();">
            
            <div class="d-flex align-items-center">
              ğŸ” Recurring Meetings
              {% for mt in meetings_today %}
                {% if mt.customer.id == customer.id %}
                  <span class="badge bg-success ms-2">Today!</span>  <!-- âœ… Shows Today! badge -->
                {% endif %}
              {% endfor %}
            </div>

            <span class="badge bg-success rounded-pill">{{ customer.recurring_meetings }}</span>
          </a>

        </div>
      
        <!-- ğŸ†• Drop a Note Button -->
        <div class="mt-3 text-center">
          <a href="{{ url_for('add_meeting') }}?customer_id={{ customer.id }}"
             class="btn btn-sm btn-primary px-3 py-1"
             onclick="event.stopPropagation();">
            Add a Note
          </a>
        </div>
        
        
      
      </div>
      
      
    </div>
  </div>
  {% endfor %}
</div>

<div class="d-flex justify-content-end align-items-center mb-4">
  <a href="{{ url_for('backup_db') }}" class="btn btn-sm btn-outline-secondary">
    â¬‡ï¸ Backup Database
  </a>
</div>

{% if request.args.get('msg') %}
  <div class="alert alert-info">{{ request.args.get('msg') }}</div>


{% endif %}

{% endblock %}
